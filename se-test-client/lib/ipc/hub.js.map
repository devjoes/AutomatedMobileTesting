{"version":3,"sources":["../../src/ipc/hub.js"],"names":["ipc","config","id","retry","sync","silent","serve","server","on","r","socket","tmr","setInterval","em","data","getEmulator","clearInterval","incrementQueueLength","udid","emit","clientId","decrementQueueLength","start","console","log"],"mappings":"2EAAA,mC;;;AAGAA,kBAAIC,MAAJ,CAAWC,EAAX,GAAgB,SAAhB;AACAF,kBAAIC,MAAJ,CAAWE,KAAX,GAAmB,IAAnB;AACAH,kBAAIC,MAAJ,CAAWG,IAAX,GAAkB,IAAlB;AACAJ,kBAAIC,MAAJ,CAAWI,MAAX,GAAoB,IAApB,C;;AAEe,gBAAQ;AACnBL,sBAAIM,KAAJ,CAAU,YAAM;AACZN,0BAAIO,MAAJ,CAAWC,EAAX,CAAc,cAAd,EAA8B,UAACC,CAAD,EAAIC,MAAJ,EAAe;AACzC,gBAAMC,MAAMC,YAAY,YAAM;AAC1B,oBAAMC,KAAKC,KAAKC,WAAL,EAAX;AACA,oBAAI,CAACF,EAAL,EAAS;AACL;AACH;AACDG,8BAAcL,GAAd;AACAG,qBAAKG,oBAAL,CAA0BJ,GAAGK,IAA7B;AACAlB,kCAAIO,MAAJ,CAAWY,IAAX,CAAgBT,MAAhB,EAAwB,sBAAsBD,EAAEW,QAAhD,EAA0DP,EAA1D;AACH,aARW,CAAZ;AASH,SAVD;AAWAb,0BAAIO,MAAJ,CAAWC,EAAX,CAAc,kBAAd,EAAkC,aAAK;AACnCM,iBAAKO,oBAAL,CAA0BZ,EAAES,IAA5B;AACH,SAFD;AAGH,KAfD;AAgBAlB,sBAAIO,MAAJ,CAAWe,KAAX;AACAC,YAAQC,GAAR,CAAY,iBAAZ;AACH,C","file":"hub.js","sourcesContent":["import ipc from 'node-ipc';\r\n\r\n\r\nipc.config.id = 'testing';\r\nipc.config.retry = 1500;\r\nipc.config.sync = true;\r\nipc.config.silent = true;\r\n\r\nexport default data => {\r\n    ipc.serve(() => {\r\n        ipc.server.on('get_emulator', (r, socket) => {\r\n            const tmr = setInterval(() => {\r\n                const em = data.getEmulator();\r\n                if (!em) {\r\n                    return;\r\n                }\r\n                clearInterval(tmr);\r\n                data.incrementQueueLength(em.udid);\r\n                ipc.server.emit(socket, 'got_emulator_for_' + r.clientId, em);\r\n            });\r\n        });\r\n        ipc.server.on('release_emulator', r => {\r\n            data.decrementQueueLength(r.udid);\r\n        });\r\n    });\r\n    ipc.server.start();\r\n    console.log('IPC Hub started');\r\n};"]}